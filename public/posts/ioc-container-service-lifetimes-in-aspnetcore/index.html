<!DOCTYPE html>
<html lang="en-us">
<head>
	<title>IOC Container Service Lifetimes in ASP.NET Core</title>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="When you&#39;re building a web application it is important to be able to control the service lifetime of the registrations in your container. The reason is that some of your objects might require being instantiated on every request while another instance should be unique and should only be instantiated once in the application lifespan.">
	<meta property="article:published_time" content="17-07-2017 00:00:00">

	<link async href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400;500;600;700" rel="stylesheet"> 
	<link async rel="stylesheet" href="/css/main.css" type="text/css" />
	<link async rel="icon" href="/favicon.ico">

	<script async src="https://kit.fontawesome.com/0d71694d01.js" crossorigin="anonymous"></script>
</head>
<body>
	<div class="grid-container">
		<header class="header">
    <div class="header-collection">
        <div class="header-item">
            <a class="header-item__link" href="/">
                <h1 class="header-item__title">Rune Nielsen | Freelance Software Developer</h1>
            </a>
        </div>     
    </div>
    <div class="header-collection">
        <div class="header-item">
            <a class="header-item__link" target="_blank" href="https://github.com/runeanielsen">
                <p class="header-item__icon">
                    <i class="fab fa-github-square"></i>
                </p>
            </a>
        </div>
        <div class="header-item">
            <a class="header-item__link" target="_blank" href="https://twitter.com/runeanielsen">
                <p class="header-item__icon">
                    <i class="fab fa-twitter-square"></i> 
                </p>
            </a>
        </div>
        <div class="header-item">
            <a class="header-item__link" target="_blank" href="https://linkedin.com/in/runeanielsen">
                <p class="header-item__icon">
                    <i class="fab fa-linkedin"></i>
                </p> 
            </a>
        </div>    
    </div>
</header>

		
<div class="blog-post">
    <div class="blog-post__content">
        <h1 id="ioc-container-service-lifetimes-in-aspnet-core">IOC Container Service Lifetimes in ASP.NET Core</h1>
<p>ASP.NET Core is designed to support and leverage dependency injection and therefore comes with a built-in inversion of control container (IOC container). If you&rsquo;re new to IOC containers you can read my introduction here <a href="/post/inversion-of-control-container">link</a>.</p>
<p>When you&rsquo;re building a web application it is important to be able to control the service lifetime of the registrations in your container. The reason is that some of your objects might require being instantiated on every request while another instance should be unique and should only be instantiated once in the application lifespan.</p>
<p>To manage the lifetimes you can make use of registration options. ASP.NET services can be configured with the following lifetimes. All of the lifetimes are configured using the <strong>IServiceCollection</strong> interface.</p>
<h2 id="transient">Transient</h2>
<p>The** transient** lifetime services are created each time the service is requested from the container. If multiple consumers depend on the service, each consumer will get their own new instance of the given service. A service should be registered as a transient lifetime if the registered type is lightweight and stateless.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#">services.AddTransient&lt;IPostService, PostService&gt;();
</code></pre></div><h2 id="scoped">Scoped</h2>
<p>When you define the service as <strong>scoped</strong>, then every request within an implicitly or explicitly defined scope will result in a single returned service from the container and that instance of the service will be disposed when the scope ends.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#">services.AddScoped&lt;IUnitOfWork, UnitOfWork&gt;();
</code></pre></div><h2 id="singleton">Singleton</h2>
<p>Using <strong>singleton</strong> there will at most be one instance of the registered service type in the container and the container will hold on to that instance until the container is disposed or goes out of scope. This means that multiple clients will get the same instance from the container.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#">services.AddSingleton&lt;ISitemapService, SitemapService&gt;();
</code></pre></div><h2 id="summary">Summary</h2>
<p>It is important to correctly register your services lifespan. There are three options to choose from.</p>
<ul>
<li>Pick transient if each object that depends on the service should get its own instance of the service when requested.</li>
<li>Pick scoped if the instance should only be instantiated once per request.</li>
<li>Pick singleton if the service should only be instantiated once and be shared between multiple clients.</li>
</ul>
   
    </div>
</div>

		<footer class="footer">
</footer>
	
	</div>
</body>
</html>
